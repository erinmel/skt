<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:skt.IDE.ViewModels"
        xmlns:texteditorviews="using:skt.IDE.Views.Editor"
        xmlns:chrome="using:skt.IDE.Views.ToolWindows.Chrome"
        xmlns:navigation="using:skt.IDE.Views.ToolWindows.Navigation"
        xmlns:compilerOutput="using:skt.IDE.Views.ToolWindows.CompilerOutput"
        xmlns:terminal="using:skt.IDE.Views.ToolWindows.Terminal"
        x:Class="skt.IDE.Views.Shell.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Icon="avares://skt.IDE/Assets/SKT.ico"
        Title="SKT IDE"
        Width="1400"
        Height="900"
        ExtendClientAreaToDecorationsHint="True"
        ExtendClientAreaChromeHints="NoChrome"
        SystemDecorations="BorderOnly"
        >

    <Window.Styles>
        <Style Selector="DropDownButton PathIcon">
            <Setter Property="IsVisible" Value="False"/>
        </Style>
    </Window.Styles>

    <Design.DataContext>
        <vm:MainWindowViewModel/>
    </Design.DataContext>


    <!-- Main Grid: Toolbar -> Content -> StatusBar -->
    <Grid x:Name="RootGrid" Margin="0">
        <Grid.RowDefinitions>
            <!-- Toolbar -->
            <RowDefinition Height="{DynamicResource ToolbarHeight}"/>
            <!-- Content -->
            <RowDefinition Height="*"/>
            <!-- Status Bar -->
            <RowDefinition Height="{DynamicResource StatusBarHeight}"/>
        </Grid.RowDefinitions>

        <!-- Toolbar -->
        <chrome:Toolbar Grid.Row="0" Name="MainToolbar" Margin="0" />

        <!-- Content Grid: Section | ToolStrip -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <!-- Section (MainView + Output) -->
                <ColumnDefinition Width="*"/>
                <!-- Tool Window Strip -->
                <ColumnDefinition Width="{DynamicResource ToolStripWidth}" 
                                  MinWidth="{DynamicResource ToolStripWidthValue}" 
                                  MaxWidth="{DynamicResource ToolStripWidthValue}"/>
            </Grid.ColumnDefinitions>

            <!-- Section Grid: MainView -> Output -->
            <Grid x:Name="SectionGrid" Grid.Column="0">
                <Grid.RowDefinitions>
                    <!-- MainView (Editor + ToolWindows) -->
                    <RowDefinition Height="*"/>
                    <!-- Output Panel -->
                    <RowDefinition Height="200" MinHeight="0"/>
                </Grid.RowDefinitions>

                <!-- MainView Grid: Editor | ToolWindows -->
                <Grid Grid.Row="0">
                    <Grid.ColumnDefinitions>
                        <!-- Editor -->
                        <ColumnDefinition Width="5*"/>
                        <!-- Tool Windows (File Explorer, etc.) -->
                        <ColumnDefinition Width="3*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Editor Area -->
                    <Border Grid.Column="0">
                        <texteditorviews:TabbedEditor Name="TabbedEditorControl" DataContext="{Binding TabbedEditorViewModel}"/>
                    </Border>

                    <!-- Horizontal Splitter between Editor and ToolWindows -->
                    <GridSplitter Grid.Column="1"
                                 Width="{DynamicResource SplitterThickness}"
                                 HorizontalAlignment="Left"
                                 ResizeDirection="Columns"
                                 Margin="0"
                                 Padding="0"
                                 ZIndex="1"/>

                    <!-- Tool Windows Area -->
                    <Border Grid.Column="1">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="{DynamicResource TabHeaderHeight}"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <Border Grid.Row="0" Padding="5" HorizontalAlignment="Center">
                                <TextBlock Text="{Binding SelectedToolWindowTitle}" FontWeight="Bold"/>
                            </Border>

                            <!-- Dynamic content based on selected tool window -->
                            <Grid Grid.Row="1">
                                <!-- File Explorer (default) -->
                                <navigation:FileExplorerView Name="FileExplorerContent" DataContext="{Binding FileExplorer}"/>

                                <!-- Tokens View -->
                                <compilerOutput:TokensView Name="TokensContent" IsVisible="False" DataContext="{Binding Tokens}"/>

                                <!-- P-Code View -->
                                <compilerOutput:PCodeView Name="PCodeContent" IsVisible="False" DataContext="{Binding PCode}"/>

                                <!-- Syntax Tree View -->
                                <compilerOutput:SyntaxTreeView Name="SyntaxTreeContent" IsVisible="False" DataContext="{Binding SyntaxTree}"/>

                                <!-- Semantic Tree View -->
                                <compilerOutput:SemanticTreeView Name="SemanticTreeContent" IsVisible="False" DataContext="{Binding SemanticTree}"/>

                                <!-- Phase Output View -->
                                <compilerOutput:PhaseOutputView Name="PhaseOutputContent" DataContext="{Binding PhaseOutput}" IsVisible="False"/>
                            </Grid>
                        </Grid>
                    </Border>
                </Grid>

                <!-- Horizontal Splitter between MainView and Output -->
                <GridSplitter Grid.Row="1"
                             Height="{DynamicResource SplitterThickness}"
                             VerticalAlignment="Top"
                             HorizontalAlignment="Stretch"
                             ResizeDirection="Rows"
                             Margin="0"
                             Padding="0"
                             ZIndex="10"/>

                <!-- Output Panel -->
                <Grid Grid.Row="1" ClipToBounds="True">
                    <terminal:TerminalPanel Name="TerminalPanelControl"
                                            Padding="0"
                                            ClipToBounds="True"
                                            VerticalAlignment="Stretch"
                                            HorizontalAlignment="Stretch" />
                </Grid>
            </Grid>

            <!-- Tool Window Strip -->
            <chrome:ToolWindowStrip Grid.Column="1" Name="ToolWindowStripControl" />
        </Grid>

        <!-- Status Bar -->
        <chrome:StatusBar Grid.Row="2"/>
    </Grid>
</Window>
