<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:skt.IDE.ViewModels"
        xmlns:texteditorviews="using:skt.IDE.Views.Editor"
        xmlns:toolviews="using:skt.IDE.Views.ToolWindows"
        xmlns:chrome="using:skt.IDE.Views.ToolWindows.Chrome"
        xmlns:navigation="using:skt.IDE.Views.ToolWindows.Navigation"
        xmlns:compilerOutput="using:skt.IDE.Views.ToolWindows.CompilerOutput"
        xmlns:terminal="using:skt.IDE.Views.ToolWindows.Terminal"
        x:Class="skt.IDE.Views.Shell.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Icon="avares://skt.IDE/Assets/SKT.ico"
        Title="SKT IDE"
        Width="1400"
        Height="900"
        ExtendClientAreaToDecorationsHint="True"
        ExtendClientAreaChromeHints="NoChrome"
        SystemDecorations="BorderOnly"
        >

    <Window.Styles>
        <Style Selector="DropDownButton PathIcon">
            <Setter Property="IsVisible" Value="False"/>
        </Style>
    </Window.Styles>

    <Design.DataContext>
        <vm:MainWindowViewModel/>
    </Design.DataContext>


    <!-- Main vertical layout: Toolbar -> Content -> Output -> StatusBar -->
    <Grid x:Name="RootGrid" Margin="0">
        <Grid.RowDefinitions>
            <!-- Toolbar -->
            <RowDefinition Height="{DynamicResource ToolbarHeight}"/>
            <!-- Content Area (Editor + Tools + ToolStrip) -->
            <RowDefinition Height="*"/>
            <!-- Terminal/Output Panel -->
            <RowDefinition Height="0" MinHeight="0"/>
            <!-- Status Bar -->
            <RowDefinition Height="{DynamicResource StatusBarHeight}"/>
        </Grid.RowDefinitions>

        <!-- Custom Toolbar with Window Controls -->
        <chrome:Toolbar Grid.Row="0" Name="MainToolbar" Margin="0" />

        <!-- Content Area: Horizontal layout (Editor | Tools | ToolStrip) -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <!-- Text Editor -->
                <ColumnDefinition Width="5*"/>
                <!-- Tools (File Explorer, etc.) -->
                <ColumnDefinition Width="3*"/>
                <!-- Tool Window Strip -->
                <ColumnDefinition Width="{DynamicResource ToolStripWidth}" 
                                  MinWidth="{DynamicResource ToolStripWidthValue}" 
                                  MaxWidth="{DynamicResource ToolStripWidthValue}"/>
            </Grid.ColumnDefinitions>

            <!-- Editor Area -->
            <Border Grid.Column="0">
                <texteditorviews:TabbedEditor Name="TabbedEditorControl" DataContext="{Binding TabbedEditorViewModel}"/>
            </Border>

            <!-- Tools Area -->
            <Border Grid.Column="1">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="{DynamicResource TabHeaderHeight}"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <Border Grid.Row="0" Padding="5" HorizontalAlignment="Center">
                        <TextBlock Text="{Binding SelectedToolWindowTitle}" FontWeight="Bold"/>
                    </Border>

                    <!-- Dynamic content based on selected tool window -->
                    <Grid Grid.Row="1">
                        <!-- File Explorer (default) -->
                        <navigation:FileExplorerView Name="FileExplorerContent" DataContext="{Binding FileExplorer}"/>

                        <!-- Tokens View -->
                        <compilerOutput:TokensView Name="TokensContent" IsVisible="False" DataContext="{Binding Tokens}"/>

                        <!-- P-Code View -->
                        <compilerOutput:PCodeView Name="PCodeContent" IsVisible="False" DataContext="{Binding PCode}"/>

                        <!-- Syntax Tree View -->
                        <compilerOutput:SyntaxTreeView Name="SyntaxTreeContent" IsVisible="False" DataContext="{Binding SyntaxTree}"/>

                        <!-- Semantic Tree View -->
                        <compilerOutput:SemanticTreeView Name="SemanticTreeContent" IsVisible="False" DataContext="{Binding SemanticTree}"/>

                        <!-- Phase Output View -->
                        <compilerOutput:PhaseOutputView Name="PhaseOutputContent" DataContext="{Binding PhaseOutput}" IsVisible="False"/>
                    </Grid>
                </Grid>
            </Border>

            <!-- Tool Window Strip -->
            <chrome:ToolWindowStrip Grid.Column="2" Name="ToolWindowStripControl" />

            <!-- Vertical Splitter between Editor and Tools -->
            <GridSplitter Grid.Column="1"
                         Width="{DynamicResource SplitterThickness}"
                         HorizontalAlignment="Left"
                         ResizeDirection="Columns"
                         Margin="0"
                         Padding="0"
                         ZIndex="1"/>
        </Grid>

        <!-- Horizontal Splitter between Content and Output -->
        <GridSplitter Grid.Row="1"
                     Height="{DynamicResource SplitterThickness}"
                     VerticalAlignment="Bottom"
                     HorizontalAlignment="Stretch"
                     ResizeDirection="Rows"
                     Margin="0"
                     Padding="0"
                     ZIndex="10"/>

        <!-- Output Panel (Terminal/Errors) -->
        <Grid Grid.Row="2" ClipToBounds="True">
            <terminal:TerminalPanel Name="TerminalPanelControl"
                                    Padding="0"
                                    ClipToBounds="True"
                                    VerticalAlignment="Stretch"
                                    HorizontalAlignment="Stretch" />
        </Grid>

        <!-- Status Bar -->
        <chrome:StatusBar Grid.Row="3"/>
    </Grid>
</Window>
